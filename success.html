<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payment Successful - Fyenance</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter+Tight:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" type="image/png" sizes="32x32" href="assets/images/favicon.ico">
    <script>
        async function fetchLatestRelease() {
            try {
                const response = await fetch('https://api.github.com/repos/ltalebli99/Fyenance/releases/latest');
                const release = await response.json();
                
                // Find assets for each platform
                const assets = release.assets;
                let windowsAsset = assets.find(asset => asset.name.endsWith('.exe'));
                let macAsset = assets.find(asset => asset.name.endsWith('.dmg'));
                let linuxAsset = assets.find(asset => asset.name.endsWith('.AppImage'));

                // Helper function to format file size
                const formatSize = (bytes) => {
                    if (bytes === 0) return '0 B';
                    const k = 1024;
                    const sizes = ['B', 'KB', 'MB', 'GB'];
                    const i = Math.floor(Math.log(bytes) / Math.log(k));
                    return `${parseFloat((bytes / Math.pow(k, i)).toFixed(1))} ${sizes[i]}`;
                };

                // Update download buttons
                if (windowsAsset) {
                    const btn = document.getElementById('windows-download');
                    btn.href = windowsAsset.browser_download_url;
                    btn.classList.remove('disabled');
                    btn.querySelector('.download-info').textContent = 
                        `v${release.tag_name.replace('v', '')} • ${formatSize(windowsAsset.size)}`;
                }
                
                if (macAsset) {
                    const btn = document.getElementById('mac-download');
                    btn.href = macAsset.browser_download_url;
                    btn.classList.remove('disabled');
                    btn.querySelector('.download-info').textContent = 
                        `v${release.tag_name.replace('v', '')} • ${formatSize(macAsset.size)}`;
                }
                
                if (linuxAsset) {
                    const btn = document.getElementById('linux-download');
                    btn.href = linuxAsset.browser_download_url;
                    btn.classList.remove('disabled');
                    btn.querySelector('.download-info').textContent = 
                        `v${release.tag_name.replace('v', '')} • ${formatSize(linuxAsset.size)}`;
                }

            } catch (error) {
                console.error('Error fetching release:', error);
                // Update error state in download info
                document.querySelectorAll('.download-info').forEach(info => {
                    info.textContent = 'Download unavailable';
                });
            }
        }

        // Call when page loads
        document.addEventListener('DOMContentLoaded', fetchLatestRelease);
    </script>
</head>
<body>
    <header>
        <nav>
            <a href="https://www.fyenanceapp.com" class="logo">
                <img src="assets/images/favicon-96x96.png" alt="Fyenance Logo" class="logo-icon">
                <h1>Fyenance</h1>
            </a>
        </nav>
    </header>

    <main>
        <section class="pricing" style="padding-top: 2rem;">
            <div class="success-card">
                <div class="success-content">
                    <div class="success-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <h2>Payment Successful!</h2>
                    <p class="subtitle">Thank you for purchasing Fyenance</p>
                    
                    <div class="success-details">
                        <div class="success-step">
                            <i class="fas fa-envelope"></i>
                            <div>
                                <h3>Check Your Email</h3>
                                <p>Your license key has been sent to your email address</p>
                            </div>
                        </div>
                        <div class="success-step">
                            <i class="fas fa-download"></i>
                            <div>
                                <h3>Download Fyenance</h3>
                                <div class="download-options" style="margin-top: 1rem;">
                                    <a id="windows-download" href="#" class="download-button disabled">
                                        <div class="download-content">
                                            <i class="fab fa-windows"></i>
                                            <span class="platform-name">Windows</span>
                                        </div>
                                        <span class="download-info">Loading...</span>
                                    </a>
                                    <a id="mac-download" href="#" class="download-button disabled">
                                        <div class="download-content">
                                            <i class="fab fa-apple"></i>
                                            <span class="platform-name">macOS</span>
                                        </div>
                                        <span class="download-info">Loading...</span>
                                    </a>
                                    <a id="linux-download" href="#" class="download-button disabled">
                                        <div class="download-content">
                                            <i class="fab fa-linux"></i>
                                            <span class="platform-name">Linux</span>
                                        </div>
                                        <span class="download-info">Loading...</span>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="footer-content">
            <div class="footer-brand">
                <img src="../assets/images/favicon-32x32.png" alt="Fyenance Logo" class="footer-logo">
                <p>© 2024 Fyenance</p>
            </div>
            <div class="footer-links">
                <a href="mailto:lucas@metromagic.io">Contact</a>
                <a href="privacy.html">Privacy Policy</a>
                <a href="terms.html">Terms of Service</a>
            </div>
        </div>
    </footer>
</body>
</html>